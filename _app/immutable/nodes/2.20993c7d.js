var ye=Object.defineProperty;var ve=(s,t,e)=>t in s?ye(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var y=(s,t,e)=>(ve(s,typeof t!="symbol"?t+"":t,e),e);import{J as W,S as re,i as ce,s as he,a as D,k as N,q as F,c as M,l as P,m as T,r as U,h as v,n as C,b as L,G as b,K as ne,L as J,H as K,M as ke,t as de,u as pe,w as Ee,y as be,N as Ce,z as Le,O as xe,A as Ne,g as Pe,d as Se,B as Te,I as ie}from"../chunks/index.393b6558.js";import{s as x,i as q,u as ue,g as H,o as Ae,P as De,a as j,l as Q,b as Me}from"../chunks/data_store.2710003d.js";import{_ as He}from"../chunks/preload-helper.41c905a7.js";function Ie({fetch:s,params:t}){return{fetch:s}}const pt=Object.freeze(Object.defineProperty({__proto__:null,load:Ie},Symbol.toStringTag,{value:"Module"}));let fe=new WeakMap,se=0;function Y(s){return fe.get(s)}class Z{constructor(t,e,n=!1){y(this,"name","");y(this,"parent");y(this,"element");y(this,"open");y(this,"child");y(this,"path");y(this,"linenumber",null);t.endsWith(".")&&(t=t.slice(0,-1));const i=t.split(".");for(let l of i[i.length-1])/^[0-9]+$/.test(l)&&(this.linenumber=+l);this.name=t,this.parent=e,this.element=document.createElement("span"),this.element.textContent=t,this.element.classList.add("link"),this.element.spellcheck=!1,this.open=n,this.element.addEventListener("click",()=>{this.set_open(!this.open),this.parent.content.save_linkstate()}),se++,this.element.id=`L${se}`,fe.set(this.element,this),this.path=this.parent.path().create_child(this.name)}set_path(t){this.name=this.path.abbreviated(this.parent.path()),this.element.textContent=this.name}remove(){var t;(t=this.child)==null||t.remove()}set_open(t){if(t!=this.open){if(this.element.classList.toggle("open"),t){let e=this.element.parentElement;if(this.child=this.parent.create_child(this.path,this),e.append(this.child.element),this.linenumber!=null){let n=this.child.content.element.childNodes.item(this.linenumber-1);n.style.background="var(--focus)"}}else this.child.remove();this.open=t}}}let S;function te(s){s!=S&&(S==null||S.set_editable(!1),S=s,S==null||S.set_editable(!0))}class ${constructor(t,e){y(this,"note");y(this,"element");y(this,"data");y(this,"saves_pending");this.note=t,this.element=document.createElement("div"),this.element.classList.add("content"),t.element.append(this.element),this.element.addEventListener("click",i=>{let l=i.target;if(l.classList.contains("link")){i.preventDefault();return}for(;l.parentElement&&!l.classList.contains("content")&&!l.classList.contains("note");)l=l.parentElement;l==this.element&&te(this)}),this.element.addEventListener("keydown",i=>{i.key=="Tab"&&i.target==this.element&&(i.preventDefault(),this.insert_text(document.createTextNode("  ")))}),this.element.addEventListener("input",i=>this.on_input(i)),this.data=x.getitem(e,i=>{}),this.setText(this.data.Content),this.saves_pending=!1;let n=x.get_linkstate(e);this.get_links().forEach((i,l)=>{n[l]&&!this.note.call_hist.includes(i.path)&&i.set_open(!0)})}setText(t){console.log("newtext",t,this);let e=t.split(`
`);for(let n of e)this.element.append(this.make_line(n))}get_text(){let t=[];for(let e of this.element.children)e.nodeName=="P"&&t.push(this.get_line_text(e));return t.join(`
`)}get_line_text(t){let e="";return t.childNodes.forEach(n=>{if(G(n)){let i=n;Y(i)==null?e+="":e+=i.textContent}else if(n.classList&&n.classList.contains("image")){let i=n;console.log(i==null?void 0:i.style.width),e+=`##image:${i==null?void 0:i.src}#${encodeURI(i==null?void 0:i.style.width)}`,console.log(e)}else n.classList&&n.classList.contains("youtubeplayer")?e+=n.src:(n.nodeName=="#text"||n.nodeName=="SPAN")&&(e+=n.textContent)}),e}make_line(t,e=!0){if(t==""){let a=document.createElement("p");return a.innerHTML="<br>",a}t=t.replaceAll(" "," "),t=t.replace(/(\S)\u00A0(\S)/g,"$1 $2");let n=t.split(/([\s+[\]{}(),])/),i=document.createElement("p"),l=[];for(let a in n){let r=Number(a),d=n[r];if(q(d)&&(!d.startsWith(".")||/\s+| | /.test(n[r-1])||n[r-1]==null))try{const f=new Z(d,this.note);l.push(f.element)}catch(f){console.log("failed link",d,f),l.push(this.make_word(d))}else l.push(this.make_word(d))}return l.forEach(a=>{i.appendChild(a)}),i}make_word(t){return new Text(t)}on_input(t){var d,f,p,c,g,k,o,m,w,u;if(this.element.contentEditable!="true"||t.target!=this.element||t.type=="input"&&["¨"].includes(t.data))return;const e=window.getSelection(),n=e==null?void 0:e.focusNode;var i=e==null?void 0:e.focusOffset,l;if(n.nodeName=="P")l=n;else if(n.nodeName=="DIV")l=n.firstChild;else if(((d=n.parentElement)==null?void 0:d.nodeName)=="P")l=n.parentElement;else if(((p=(f=n.parentElement)==null?void 0:f.parentElement)==null?void 0:p.nodeName)=="P")l=(c=n.parentElement)==null?void 0:c.parentElement;else{this.element.childNodes.forEach(h=>{if(h.nodeName!="P"){const _=document.createElement("p");h.nodeName=="DIV"?(h.replaceWith(_),_.appendChild(h.firstChild)):(h.replaceWith(_),_.appendChild(h)),z(_,0)}});return}if(t.inputType=="insertParagraph"){const h=l.previousElementSibling;((g=h.lastChild)==null?void 0:g.textContent)==""&&((k=h.lastChild)==null||k.remove()),this.reload_line(h),(m=l.firstChild)==null||m.replaceWith((o=l.firstChild)==null?void 0:o.textContent);const _=this.reload_line(l);z(_,0);const E=h.textContent;if(E){const A=(E==null?void 0:E.length)-E.trimStart().length+(["{","[","("].includes(E.slice(-1))?2:0);A&&(this.insert_text(document.createTextNode(" ".repeat(A))),z(_,A))}return}let a=this.get_line_text(l);if(a!=""){let h=n;if(n.nodeName=="P"?(h=n.childNodes[i],i=0):((w=n.parentElement)==null?void 0:w.nodeName)=="SPAN"&&(h=n.parentElement),h==null){console.warn("prev is undefined");return}for(h=h.previousSibling;h!=null;)i+=(u=h.textContent)==null?void 0:u.length,h=h.previousSibling}else i=0;const r=this.reload_line(l,a);z(r,i),this.save_lazy()}get_links(){let t=[];return this.element.childNodes.forEach(e=>{e.nodeName=="P"&&e.childNodes.forEach(n=>{if(G(n)){let i=Y(n);i&&t.push(i)}})}),t}save_linkstate(){let t=[];this.get_links().forEach(e=>t.push(e.open)),x.set_linkstate(this.note.path(),t)}save_lazy(){this.saves_pending||(this.saves_pending=!0,setTimeout(()=>{this.saves_pending&&this.save()},1e3))}save(){this.data.Content=this.get_text(),this.saves_pending=!1,x.setitem(this.data)}reload_line(t,e){e==null&&(e=this.get_line_text(t));const n=this.make_line(e);return t.replaceWith(n),t.childNodes.forEach(i=>{if(G(i)){const l=Y(i);l==null||l.remove()}}),n}insert_text(t){const e=window.getSelection();e.deleteFromDocument(),e.getRangeAt(0).insertNode(t),t.parentElement instanceof HTMLBRElement&&(t.parentElement.replaceWith(t),console.log("replaced br")),e.collapseToEnd();const n=document.createRange();n.selectNodeContents(t),n.collapse(!1);const i=window.getSelection();i.removeAllRanges(),i.addRange(n)}set_editable(t){W(ue)==this.data.Path.author&&(t?(this.element.contentEditable="true",this.element.focus()):this.element.contentEditable="false")}}function G(s){return s instanceof HTMLElement&&s.classList.contains("link")}function z(s,t){var i,l;let e=s.firstChild;for(;t>((i=e==null?void 0:e.textContent)==null?void 0:i.length);)t-=(l=e==null?void 0:e.textContent)==null?void 0:l.length,e=e==null?void 0:e.nextSibling;let n=null;return e!=null&&(e.nodeName=="SPAN"?(n=e,e=e.firstChild):n=e),We(e,t),n}function We(s,t){var e=document.createRange(),n=window.getSelection();try{e.setStart(s,t),e.collapse(!0)}catch{}n!=null&&(n.removeAllRanges(),n.addRange(e))}function Re(s,t){s.preventDefault();let e=document.createElement("div");e.style.position="fixed",e.style.top=s.pageY-window.scrollY+"px",e.style.left=s.pageX+"px",e.style.backgroundColor="var(--focus)",e.style.border="2px solid grey",e.style.padding=".5em",e.style.cursor="pointer";{const i=[{tag:"share link",fn:async l=>{await navigator.clipboard.writeText(location.origin+"?"+t.path().tostring().replace("#","")),l.textContent="copied."}},{tag:`expand note ${t.path().mini()}`,fn:async l=>{window.location.search=t.path().tostring().replace("#","")}}];for(let{tag:l,fn:a}of i){let r=document.createElement("p");r.textContent=l,r.addEventListener("click",d=>a(r)),r.style.padding=".2em",e.append(r)}}let n=document.querySelector("#page");n==null||n.appendChild(e),window.addEventListener("click",()=>e.remove()),e.addEventListener("mouseleave",()=>e.remove())}class me extends ${constructor(e,n){super(e,n);y(this,"outfield");this.element.classList.add("js"),this.element.spellcheck=!1;let i=document.createElement("div");i.classList.add("runbutton"),i.textContent="▶",i.addEventListener("click",l=>this.execute()),this.element.addEventListener("keydown",l=>{console.log(l),l.ctrlKey&&l.key=="Enter"&&this.execute()}),this.element.parentElement.append(i),this.outfield=document.createElement("div"),this.outfield.classList.add("content"),this.element.parentElement.append(this.outfield)}make_word(e){let n=new Text(e);return Ue.forEach(i=>{i.pattern(e)&&(n=document.createElement("span"),n.textContent=e,n.style.color=i.color)}),n}async get_flat_text(e,n){e=e.replaceAll(/print\s*\(/g,"print(");const i=e.split(`
`);let l=[];return[(await Promise.all(i.map(async(r,d)=>{if(/print\s*\(/.test(r)&&(r=r.replaceAll(/print\s*\(/g,`print('${n.data.Path.tostring()}:${d+1}',`)),r.trimStart().startsWith("//"))return;let f=r.split(/([\s+[\]{}(),])/);return(await Promise.all(f.map(async(p,c)=>{if(q(p)&&(!p.startsWith(".")||/\s+| | /.test(f[c-1])||f[c-1]==null)){const g=new Z(p,n.note,!0),k=g.path.tostring().replaceAll(".","$").replaceAll(":","$$$$").replace("#","");return l.push([k,g]),k}return p}))).join("")}))).filter(r=>!(r!=null&&r.startsWith("//"))).join(`
`),l]}async get_content_text(e,n,i){const l=(await x.getitemblocking(n)).Content;let[a,r]=await this.get_flat_text(l,e);for(let[d,f]of r)if(!i.vars.has(d)){i.vars.add(d);const p=new I(f.path,f),c=await this.get_content_text(p.content,f.path,i);i.values.push([d,c])}return a}async execute(){this.save(),this.outfield.innerHTML="",window.print=(...i)=>{this.print(...i)};let e={vars:new Set,values:new Array},n=await this.get_content_text(this,this.data.Path,e);console.log(n);try{let l=Function(n)();this.print(l)}catch(i){this.print("error",i)}}print(...e){let n=e[0];e=e.slice(1);let i=document.createElement("p"),l=new Z(n,this.note);l.element.style.float="right",i.append(l.element);for(let a of e)i.append(document.createTextNode(a)),i.append(document.createTextNode(" "));this.outfield.append(i)}}let Fe=["abstract","arguments","await","boolean","break","byte","case","catch","char","class","const","continue","debugger","default","delete","do","double","else","enum","eval","export","extends","false","final","finally","float","for","function","goto","if","implements","import","in","instanceof","int","interface","let","long","native","new","null","package","private","protected","public","return","short","static","super","switch","synchronized","this","throw","throws","transient","true","try","typeof","var","void","volatile","while","with","yield"];const Ue=[{pattern:s=>/[\[\]{}()]/.test(s),color:"yellow"},{pattern:s=>Fe.includes(s),color:"lightblue"},{pattern:s=>!isNaN(parseFloat(s)),color:"orange"},{pattern:s=>/^"(.*)"/.test(s),color:"orange"}];let O,R=null,B=(...s)=>{R==null||R.print(...s)};async function je(){console.log("python setup..."),B("python setup ..."),await He(()=>import("https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"),[],import.meta.url),O=await loadPyodide({stdout:B}),R.outfield.innerHTML=""}async function ge(s){if(console.log("run python"),O==null)return await je(),ge(s);let e=s.split(`
`).filter(i=>/^\%pip\s*install/.test(i)).map(i=>i.split(/^\%pip\s*install/)[1].trim());for(let i of e)await O.loadPackage(i);return s=s.replace(/^\%pip\s*install\s*.*/,""),O.runPython(s)}let ze=["False","await","else","import","pass","None","break","except","in","raise","True","class","finally","is","return","and","continue","for","lambda","try","as","def","from","nonlocal","while","assert","del","global","not","with","async","elif","if","or","yield"];const Oe=[{pattern:s=>/[\[\]{}()]/.test(s),color:"yellow"},{pattern:s=>ze.includes(s),color:"lightblue"},{pattern:s=>!isNaN(parseFloat(s)),color:"orange"},{pattern:s=>/^"(.*)"/.test(s),color:"orange"}];function Ve(s){let t=new Text(s);return Oe.forEach(e=>{e.pattern(s)&&(t=document.createElement("span"),t.textContent=s,t.style.color=e.color)}),t}class Ke extends me{async execute(){this.outfield.innerHTML="";let t=this.get_text();R=this,t=t.replaceAll(" "," "),ge(t).catch(e=>{console.log(e),this.handle_error(e)}).then(e=>{B(e)})}handle_error(t){let e=t.stack.split(`
`);console.log(e),e.filter(n=>n.startsWith('  File "<exec>", line')||!n.startsWith(" ")&&!n.startsWith("PythonError:")).map(n=>B(n))}on_input(t){super.on_input(t)}make_word(t){return Ve(t)}print(...t){let e=document.createElement("p");for(let n of t)e.textContent+=String(n);this.outfield.append(e)}}var qe=s=>new Promise((t,e)=>{console.log("rename_note",s);const n=document.createElement("div");n.classList.add("bg"),n.addEventListener("click",p=>{p.target==n&&(n.remove(),e())}),document.querySelector("#page").appendChild(n);const i=document.createElement("div");i.classList.add("container"),n.appendChild(i);const l=document.createElement("h2");l.innerHTML="rename note";const a=document.createElement("input");a.value=s.tostring();const r=document.createElement("p"),d=()=>{const p=H(a.value);p!=s?(t(p),n.remove()):r.innerHTML="invalid name"};a.addEventListener("keyup",p=>{p.key=="Enter"&&d()});const f=document.createElement("button");f.innerHTML="rename",f.onclick=()=>d(),i.appendChild(l),i.appendChild(a),i.appendChild(r),i.appendChild(document.createElement("br")),i.appendChild(f)});class I{constructor(t,e){y(this,"creator");y(this,"element");y(this,"head");y(this,"content");y(this,"language");y(this,"call_hist",[]);this.path=()=>t,this.creator=e,this.element=document.createElement("div"),this.element.classList.add("note"),this.head=new Be(this,t),this.element.append(this.head.element),this.language=t.get_language(),this.language=="txt"?this.content=new $(this,t):this.language=="js"?this.content=new me(this,t):this.language=="py"?this.content=new Ke(this,t):this.content=new $(this,t),e&&(this.call_hist=e.parent.call_hist.concat(e.parent.path())),this.element.addEventListener("click",n=>{this.content.element.contains(n.target)||(te(null),n.preventDefault())})}path(){return this.content.data.Path}remove(){this.content.save(),this.content.save_linkstate(),this.element.remove()}create_child(t,e){return new I(t,e)}}class Be{constructor(t,e){y(this,"note");y(this,"element");this.note=t,this.element=document.createElement("div"),this.element.classList.add("head");let n=document.createElement("h2"),i;this.note.creator?i=e.relative_path(this.note.creator.parent.path()).mini():i=e.mini(),n.textContent=i,this.element.append(n),this.note.element.append(this.element),this.element.addEventListener("click",l=>{qe(this.note.content.data.Path).then(a=>{let r=x.getitem(a,d=>{this.note.content.data.id=d.id,this.note.content.save()});this.note.content.data.Path=a,this.note.content.data.id=r.id,i=t.content.data.Path.relative_path(this.note.creator.parent.path()).mini(),this.element.textContent=i})}),this.element.addEventListener("contextmenu",l=>{Re(l,this.note)})}}var V=new Map,X=[],ee=!1;function Je(){for(let s=0;s<localStorage.length;s++){const t=localStorage.key(s);try{const e=JSON.parse(t);e.location&&Ye(e)}catch{}}}function Ye(s){const t=(s.pub?"":"_")+s.location.join(".")+":"+s.author,e=V.size;V.set(t,s),e!=V.size&&(ee=!0)}function Ge(){return ee&&(X=Array.from(V),X.sort((s,t)=>s[0].localeCompare(t[0])),ee=!1),X}function Xe(){const s=prompt("enter openai key");s&&Ae.set(s)}const Qe={tags:["openai","ai","gpt"],rep:"⚙️ add openai key",executor:Xe};function _e(s,t){return typeof s=="string"?s.startsWith(t):typeof s=="function"?s(t):s.reduce((e,n)=>e||_e(n,t),!1)}let Ze=[{tags:["lightmode","darkmode"],rep:"⚙️ switch lightmode",executor:()=>{Q.set(!W(Q))}},{tags:["account","login","signup","sign in","log out","sign out","user account"],rep:"⚙️ account settings",executor:()=>{window.location.pathname="login"}},Qe],we;function $e(){let s=Ge().map(t=>{const e=decodeURI(t[0]).replaceAll("_"," ").trimStart(),n=(t[1].pub?"📃 ":"🔒 ")+e.replace(":"," by ");return{tags:e,rep:n,executor:()=>{const l=new De(t[1].pub,t[1].author,t[1].location).tostring();window.location.search=l.replace("#",""),j.update(a=>(a[n]=Date.now(),a)),console.log(W(j))}}}).sort((t,e)=>(W(j)[e.rep]??0)-(W(j)[t.rep]??0));we=Ze.concat(...s)}function et(s,t=10){return we.filter(n=>_e(n.tags,s)).slice(0,t)}function le(s,t,e){const n=s.slice();return n[11]=t[e],n[13]=e,n}function tt(s){let t,e,n,i;return{c(){t=N("button"),e=F("⚙︎"),this.h()},l(l){t=P(l,"BUTTON",{id:!0});var a=T(t);e=U(a,"⚙︎"),a.forEach(v),this.h()},h(){C(t,"id","search_btn")},m(l,a){L(l,t,a),b(t,e),n||(i=J(t,"click",s[7]),n=!0)},p:K,d(l){l&&v(t),n=!1,i()}}}function nt(s){let t,e,n,i;return{c(){t=N("span"),e=F(">> Cmd + P"),this.h()},l(l){t=P(l,"SPAN",{id:!0});var a=T(t);e=U(a,">> Cmd + P"),a.forEach(v),this.h()},h(){C(t,"id","search_btn")},m(l,a){L(l,t,a),b(t,e),n||(i=J(t,"click",s[6]),n=!0)},p:K,d(l){l&&v(t),n=!1,i()}}}function ae(s){let t,e=(typeof s[11].rep=="string"?s[11].rep:s[11].rep(s[2]))+"",n,i,l,a,r,d;function f(){return s[10](s[11])}return{c(){t=N("p"),n=F(e),l=D(),a=N("br"),this.h()},l(p){t=P(p,"P",{class:!0});var c=T(t);n=U(c,e),c.forEach(v),l=M(p),a=P(p,"BR",{}),this.h()},h(){C(t,"class",i=s[13]==s[4]?"highlighted":"")},m(p,c){L(p,t,c),b(t,n),L(p,l,c),L(p,a,c),r||(d=J(t,"click",f),r=!0)},p(p,c){s=p,c&12&&e!==(e=(typeof s[11].rep=="string"?s[11].rep:s[11].rep(s[2]))+"")&&pe(n,e),c&16&&i!==(i=s[13]==s[4]?"highlighted":"")&&C(t,"class",i)},d(p){p&&v(t),p&&v(l),p&&v(a),r=!1,d()}}}function it(s){let t,e,n,i,l,a,r,d,f,p,c;function g(u,h){return u[5]?nt:tt}let k=g(s),o=k(s),m=s[3],w=[];for(let u=0;u<m.length;u+=1)w[u]=ae(le(s,m,u));return{c(){o.c(),t=D(),e=N("div"),n=N("p"),i=F(oe),l=D(),a=N("input"),r=D(),d=N("div");for(let u=0;u<w.length;u+=1)w[u].c();this.h()},l(u){o.l(u),t=M(u),e=P(u,"DIV",{class:!0});var h=T(e);n=P(h,"P",{id:!0});var _=T(n);i=U(_,oe),_.forEach(v),l=M(h),a=P(h,"INPUT",{placeholder:!0,type:!0}),r=M(h),d=P(h,"DIV",{class:!0});var E=T(d);for(let A=0;A<w.length;A+=1)w[A].l(E);E.forEach(v),h.forEach(v),this.h()},h(){C(n,"id","searchsuggestion"),C(a,"placeholder","search..."),C(a,"type","text"),C(d,"class","results"),C(e,"class","searchbar"),e.hidden=f=!s[0]},m(u,h){o.m(u,h),L(u,t,h),L(u,e,h),b(e,n),b(n,i),b(e,l),b(e,a),s[8](a),ne(a,s[2]),b(e,r),b(e,d);for(let _=0;_<w.length;_+=1)w[_].m(d,null);p||(c=J(a,"input",s[9]),p=!0)},p(u,[h]){if(k===(k=g(u))&&o?o.p(u,h):(o.d(1),o=k(u),o&&(o.c(),o.m(t.parentNode,t))),h&4&&a.value!==u[2]&&ne(a,u[2]),h&28){m=u[3];let _;for(_=0;_<m.length;_+=1){const E=le(u,m,_);w[_]?w[_].p(E,h):(w[_]=ae(E),w[_].c(),w[_].m(d,null))}for(;_<w.length;_+=1)w[_].d(1);w.length=m.length}h&1&&f!==(f=!u[0])&&(e.hidden=f)},i:K,o:K,d(u){o.d(u),u&&v(t),u&&v(e),s[8](null),ke(w,u),p=!1,c()}}}let oe="";function st(s,t,e){let n=!1,i="",l=[],a=0;window.addEventListener("keydown",o=>{o.key=="p"?o.metaKey&&(o.preventDefault(),e(0,n=!0)):o.key=="Escape"&&e(0,n=!1)}),window.addEventListener("keyup",o=>{if(n&&!(o.key=="Meta"||o.key=="Escape"))if(o.key=="ArrowUp")e(4,a=Math.max(a-1,0));else if(o.key=="ArrowDown")e(4,a=Math.min(a+1,l.length-1));else if(o.key=="Tab"){o.preventDefault();let m=l[a].tags;typeof m=="string"&&(m=m.split(":")[0],m=m.split(".").slice(0,i.split(".").length).join("."),e(2,i=m),r.focus())}else if(o.key=="Enter")l[a].executor(i);else{if(i==""){e(3,l=[]);return}e(4,a=0),e(3,l=et(i)),l.length==0&&e(3,l=[{tags:m=>!0,rep:m=>`⚙️ create Page: ${m}`,executor:m=>{const w=new I(H("#"+m));x.setitem(w.content.data),window.location.search=m}},{tags:m=>!0,rep:m=>`⚙️ create secret Page: ${m}`,executor:m=>{const w=new I(H("_"+m));x.setitem(w.content.data),window.location.search="_"+m}}]),l[0]}}),window.addEventListener("click",o=>{o.target.id!="search_btn"&&(e(0,n=!1),e(5,d=!1))});let r,d=!1;const f=()=>{e(5,d=!1),e(0,n=!0)},p=o=>{e(5,d=!0)};function c(o){Ee[o?"unshift":"push"](()=>{r=o,e(1,r)})}function g(){i=this.value,e(2,i)}const k=o=>{o.executor(i)};return s.$$.update=()=>{s.$$.dirty&3&&n&&($e(),de().then(()=>{r.focus()}))},[n,r,i,l,a,d,f,p,c,g,k]}class lt extends re{constructor(t){super(),ce(this,t,st,it,he,{})}}function at(s){let t,e,n,i,l,a=s[1]?"":"offline",r,d,f,p;return t=new lt({}),{c(){be(t.$$.fragment),e=D(),n=N("h2"),i=new Ce(!1),l=D(),r=F(a),d=D(),f=N("div"),this.h()},l(c){Le(t.$$.fragment,c),e=M(c),n=P(c,"H2",{id:!0});var g=T(n);i=xe(g,!1),l=M(g),r=U(g,a),g.forEach(v),d=M(c),f=P(c,"DIV",{id:!0});var k=T(f);k.forEach(v),this.h()},h(){i.a=l,C(n,"id","fullheader"),C(f,"id","page")},m(c,g){Ne(t,c,g),L(c,e,g),L(c,n,g),i.m(s[0],n),b(n,l),b(n,r),L(c,d,g),L(c,f,g),p=!0},p(c,[g]){(!p||g&1)&&i.p(c[0]),(!p||g&2)&&a!==(a=c[1]?"":"offline")&&pe(r,a)},i(c){p||(Pe(t.$$.fragment,c),p=!0)},o(c){Se(t.$$.fragment,c),p=!1},d(c){Te(t,c),c&&v(e),c&&v(n),c&&v(d),c&&v(f)}}}function ot(s,t,e){let n,i;ie(s,ue,o=>e(8,n=o)),ie(s,Me,o=>e(1,i=o));let{data:l}=t;document.title=window.location.hostname;var a,r="<br>";a=`<a href=/ onclick="window.location.href = '${window.origin}'; location.reload();" id=homebtn>sciepedia</a>`,r=a,de().then(k);let d;const f=`Click me and write something: xzxysl ... &^

You can create a new link with # followed by text, for example: #link #recursion #whatever

Click on a link to open a page. If the page already exists, it will be displayed to you.

Almost forgot! Create an account: {}/login, and then you can create public pages.

If you want to learn more, check out: #sciepedia:kormann
`;let p,c;n[0];let g={path:"_home:"+n};async function k(){Je(),window.fetch=l.fetch,Q.subscribe(h=>{h?document.body.classList.add("light"):document.body.classList.remove("light")}),d=document.createElement("div"),d.innerHTML="<p>this is a pred</p><p>this is a pred</p><p>this is a pred</p>",d.id="pred",a=`<a href=/ onclick="setTimeout(()=>{window.location.href='${window.origin}'})" id=homebtn>sciepedia</a>`,e(0,r=a);let o=window.location.search;c=[H(g.path)],o&&o.length>1&&(o=decodeURI(o.slice(1)),q(o)||(o="#"+o),console.log("searching:",o),q(o)&&(c.push(c[0]),g.path=o)),p=document.querySelector("#page");const m=H("_tutorial:"+n);x.has(m)||x.setitem({Path:m,Content:f.replace("{}",window.location.origin),id:crypto.randomUUID()});let w=H(g.path);if(!x.has(w)){const h={Path:w,Content:`welcome to #sciepedia:kormann
if you're new try out the tutorial: _tutorial`,id:crypto.randomUUID()};localStorage[JSON.stringify(h.Path)]=JSON.stringify(h)}let u=new I(w);p.appendChild(u.element),document.body.addEventListener("click",h=>{h.target==document.body&&te(null)}),window.addEventListener("onunload",h=>{localStorage.unloading=!0,u.remove(),localStorage.unloaded=!0})}return s.$$set=o=>{"data"in o&&e(2,l=o.data)},[r,i,l]}class ut extends re{constructor(t){super(),ce(this,t,ot,at,he,{data:2})}}export{ut as component,pt as universal};
